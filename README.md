# tiktok-bot
Бот, загружающий видео из TikTok ответом на ссылку в беседе

## Настройки
Скопировать файл `.env.example` и переименовать в `.env`.
- `TOKEN` - ключ доступа для сообщества
- `USER_TOKEN` - ключ доступа для пользователя
- `GROUP_ID` - ID сообщества
- `ADMIN_PEER_ID` - ID чата с администрацией
- `COOKIE` - хедер с куками
### Получение ключей доступа
#### В сообществе
Перейти в *Управление*, затем *Настройки* и *Работа с API*, оставить вкладку *Ключи доступа*.
Нажать *Создать ключ*, выбрать **права доступа для ключа доступа**: управление сообществом, сообщения сообщества. Подтвердить, скопировать ключ и вставить в настройки.

Перейти на вкладку *Long Poll API*:
- **Long Poll API**: Включено
- **Версия API**: 5.131 и выше
- **Типы событий**: Входящее сообщение

#### У пользователя
**Пользователь должен быть администратором в сообществе.**
Получить токен через [vkhost.github.io](https://vkhost.github.io) - выбрать `VK API`, затем скопировать из адресной строки после `access_token=` и до `&`, вставить в настройки.

### ID сообщества
Перейти в *Управление*, затем *Настройки*. В разделе *Основная информация* под *Адрес* скопировать *Номер сообщества*, оставив только цифры, вставить в настройки.

### ID чата с администрацией
Указать ID своей страницы ВКонтакте. Для этого нужно открыть любую фотографию/запись и скопировать цифры после `photo` или `wall` и до `_`, вставить в настройки.

### Хедер с куками
Открываем [любое видео в TikTok](https://www.tiktok.com/@philandmore/video/6805867805452324102). Жмём ПКМ по странице и *Просмотреть код*. Переходим на вкладку *Network* и перезагружаем страницу. Среди списка запросов ищем самый первый и нажимаем на него. В открывшемся окне листаем почти в самый низ и ищем строку `cookie: ...`. Нажимаем по этой строке ПКМ, затем *Copy value*. Вставляем в настройки то, что скопировалось.

## Запуск
Подразумевается, что у вас уже установлена [NodeJS](https://nodejs.org/ru/).
- Устанавливаем модули командой `npm i`
- Собираем проект командой `npm run build`
- Запускаем готовый проект командой `npm run start`

При последующих запусках нужно использовать только последнюю команду.
